== Woda - Server

== Required installations

First thing first: what is rvm (https://rvm.io/).

The simplest way to install rvm is with:
       curl -L https://get.rvm.io | bash -s stable

If you use something other than bash as your shell, put this in your *.$(your_shell)rc*  (checked on zsh):
       [[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm"

Then install any ruby using this (1.9.3 is the ruby version of this project):
       rvm install 1.9.3

Then to use the ruby version you've installed, run: 
       rvm use --default $ruby_version

== Required libraries

Before running _bundle install_ command, please make sure you have these libraries installed.
* libxml2-dev
* libxslt1-dev
* libmysqlclient-dev
* libpq-dev

or simply run the following command :  
       sudo apt-get install libxml2-dev libxslt1-dev libmysqlclient-dev libpq-dev

== Gems

Gems are little ruby packages. Mostly they are libs but they can sometimes be small utilities (such as the 'bundler' gem)

There is a file called 'Gemfile' in the base directory. This is to be used with the gem 'bundler'.
To install the gems required by the program, just type before launching:
       bundle install

This command line doesn't update gems, it just installs them. To update your gems use:
       bundle update

You should avoid installing gems with anything else than the previous lines, and always add the new gems you use to the Gemfile.

== Launching the server

First of all run:
       bundle install

This will do a bunch of things and then possibly crash on you. If so, it's because you don't have the necessary packages, use @sudo aptitude install@ or something to get them.
You need gcc, make & cie., as well as libpq-dev, libmysqlclient-dev and possibly others. Just try to understand the error messages.

Then prepare the db with: 
       bundle exec rake db:migrate

And finally launch the server (on http://127.0.0.1:3000) with:
       bundle exec rails s

You can perform some actions to this server using the webservices with a curl command: 
       curl -k cookies.txt -c cookies.txt -b https://127.0.0.1/ -X [REST Methods] -d "argument1=value1&arguement2=value2"

And that's how it's done. The default db is sqlite, so don't worry about having a mysql server or whatever. Not necessary.

If you really want to change the db, look at the @config/database.yml@ file, and use https://github.com/datamapper/dm-rails#sample-databaseyml-files to understand how to modify it.

== Deployment

To deploy the server, install everything and then run:

       /script/start_server
       /script/stop_server

== Unit tests

The testing framework we use for unit testing is *rspec*. Launch the tests using:
       bundle exec rspec

You can use continuous testing with:
       bundle exec autotest -q

If you want to write your own tests (and you *should*), look up the files in the *spec* directory. The file must have the same path and name as the file you're testing and end in *_spec.rb*.

Launch the *script/setup_project* to install stuff that everyone of you should use. In particular, this will install git hooks that will launch the tests at every commit, and prevent the commit if a test fails or if the test coverage is less than 95%.

*Try to keep the test coverage at 100% !*
